search()
library()
sessionInfo()
search()
?glm
library(scZINB)
load_all()
document()
devtools::document()
?nsZINB
devtools::document()
?nsZINB
devtools::document()
?nsZINB
devtools::document()
?nsZINB
devtools::document()
?gentp
devtools::document()
?gentp
devtools::document()
?nsZINB
devtools::document()
?nsZINB
devtools::document()
?gentp
devtools::document()
?gentp
library(scZINB)
library(scZINB)
?gendata
library(scZINB)
?gendata
library(scZINB)
?gendata
library(scZINB)
?genER
genER(10, 0.1, 20, 0.5)
genER
genER <- function(p, pE, n, effS = NULL) {
stopifnot(pE>0,pE<1)
A = matrix(0,p,p)
w = which(lower.tri(A))
if(is.null(effS)){
effS = runif(n=length(w),min = 0, max = 1)
}
A[w] = rbinom(n=length(w),size=1,prob=pE)*effS
Sigh = solve(diag(p) - A)
X = rmvnorm(n=n,sigma = Sigh %*% t(Sigh))
# shuffling
id.shuffle = sample(1:p,p,replace=FALSE)
A = A[id.shuffle,id.shuffle]
X = X[,id.shuffle]
return(list(A=A,X=X, G=as(t(A),"graphNEL")))
}
genER(10, 0.1, 20, 0.5)
library(scZINB)
library(scZINB)
genER
genER(10, 0.1, 5)
devtools::session_info()
library(mvtnorm)
genER(10, 0.1, 5)
library(graph)
genER(10, 0.1, 5)
devtools::document()
rm(list = c("genER"))
library(scZINB)
?pcZINB
devtools::document()
?pcZINB
devtools::document()
?marscr
library(scZINB)
?marscr
?genER
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
mirror
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
?theta_ml
devtools::document()
library(scZINB)
devtools::use_rcpp()
library(scZINB)
library(scZINB)
devtools::use_rcpp()
devtools::document()
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
devtools::use_vignette("scZINB_vignette")
usethis::use_vignette("my-vignette")
install.packages("rmarkdown")
usethis::use_vignette("my-vignette")
usethis::use_vignette("scZINB_vignette")
library(scZINB)
vignette(package = scZINB)
?vignette
?vignettes
vignette(all = FALSE)
library(scZINB)
browseVignettes("scZINB")
vignette()
library(scZINB)
browseVignettes("scZINB")
vignette(package = "scZINB")
library(scZINB)
library(scZINB)
vignette("scZINB_vignette")
browseVignettes("scZINB")
devtools::build_vignettes()
devtools::build_vignettes()
devtools::use_vignette("scZINB_vignette")
useit::use_vignette("scZINB_vignette")
usethis::use_vignette("scZINB_vignette")
devtools::build_vignettes()
library(scZINB)
browseVignettes("scZINB")
devtools::build_vignettes()
library(scZINB)
file.exists("~/.ssh/id_rsa.pub")
file.exists("~/.ssh/id_rsa.pub")
getwd()
getwd()
devtools::session_info()
library(roxygen2)
list.files()
list.files()
roxygenize("scZINB")
library(scZINB)
library(scZINB)
library(scZINB)
ZINB
penZINB
data
dat
library(scZINB)
?penZINB
?nsZINB
library(doParallel)
library(penalized) # for penalized
library(MASS) # for negative.binomal() and glm.nb
library(pscl) # for zeroinfl function
library(graph)
library(mvtnorm)
set.seed(1)
ts <- genER(100, 0.01, 200, 0.5)
graph <- ts$A
graph <- (graph != 0) * 1
mgraph <- mirror(graph)
dim(mgraph)
dat <- ts$X
dim(dat)
## -----------------------------------------------------------------------------
data.negbin <- matrix(qnbinom(pnorm(dat), mu = 2, size = 1.5), ncol = ncol(dat))
data.bin <- matrix(qbinom(pnorm(dat), prob = 0.4, size = 1), ncol = ncol(dat))
data <- data.negbin
data[which(data.bin == 0)] <- 0
data[which(data == Inf)] <- max(data[which(data != Inf)]) + 1
head(data[, 1:6])
## -----------------------------------------------------------------------------
# step 0 marginal screening
gEstM <- marscr(log(data + 1/6), thres = 10)
mgh1 <- nsZINB(data, filter = gEstM)
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
library(scZINB)
